---
title: "Regularization - Exercise 2"
subtitle: "[Supervised Learning](https://slds-lmu.github.io/i2ml/)"
notebook-view:  false
---

::: {.content-hidden when-format="pdf"}
::: {.hidden}
{{< include ../_quarto/latex-math.qmd >}}
:::
:::

::: {.content-visible when-profile="solution"}
::: callout-tip
You can run the notebooks in Google Colab here: [R](https://colab.research.google.com/github/slds-lmu/lecture_sl/blob/main/exercises/regularization-quarto/inserted/sol_regularization_quarto_2_R.ipynb), [Python](https://colab.research.google.com/github/slds-lmu/lecture_sl/blob/main/exercises/regularization-quarto/inserted/sol_regularization_quarto_2_py.ipynb).
:::
:::

# Exercise 1 (a - vi): Soft Thresholding Operator
$$\theta^*_j =\begin{cases}
    \frac{\rho_j + \lambda}{z_j} & \text{ for } \rho_j < -\lambda\\
    0 & \text{ for }  -\lambda \leq \rho_j \leq \lambda\\
   \frac{\rho_j - \lambda}{z_j} & \text{ for } \rho_j > \lambda
\end{cases}$$

Plot $\theta^*_j$ as a function of $\rho_j$ for $\rho_j \in [-5, 5], \lambda = 1, z_j = 1.$ This function is called the soft thresholding operator.

::: {.content-visible when-profile="solution"}

::: {.panel-tabset}
### R
{{< embed sol_regularization_2_R.ipynb#soft_thresholding_plot_data echo=true >}}
### Python
{{< embed sol_regularization_2_py.ipynb#soft_thresholding_plot_data echo=true >}}
:::

Plotting

::: {.panel-tabset}
### R
{{< embed sol_regularization_2_R.ipynb#soft_thresholding_plot echo=true >}}
### Python
{{< embed sol_regularization_2_py.ipynb#soft_thresholding_plot echo=true >}}
:::

## Interpretation of the Soft Thresholding Operator
As we can see from the plot the coefficient $\theta^*_j$ is equal to zero when $\rho_j$ is between $-\lambda$ and $\lambda$, and therefore performs feature selection.

# Exercise 1 (d): Lasso vs. Projected Lasso Comparison

You are given the code below to compare the quality of the projected Lasso regression vs. the regular Lasso regression.

Complete the missing code of the algorithms and interpret the result.

::: {.panel-tabset}
### R
{{< embed sol_regularization_2_R.ipynb#lasso_vs_projected_exercise_code_part_1 echo=true >}}
### Python
{{< embed sol_regularization_2_py.ipynb#lasso_vs_projected_exercise_code_part_1 echo=true >}}
:::

No need to make changes in the code below

::: {.panel-tabset}
### R
{{< embed sol_regularization_2_R.ipynb#lasso_vs_projected_exercise_code_part_2 echo=true >}}
### Python
{{< embed sol_regularization_2_py.ipynb#lasso_vs_projected_exercise_code_part_2 echo=true >}}
:::


::: 

